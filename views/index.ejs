<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Vaftiz's Url Shortener Service</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" />
  </head>
  <body>
    <div class="container p-4">
      <% if (typeof error !== "undefined") { %>
      <div class="alert alert-danger" role="alert"><%- error %></div>
      <% } %> <% if (typeof success !== "undefined") { %>
      <div class="alert alert-success" role="alert"><%- success %></div>
      <% } %>
      <h1>Because why not.</h1>

      <form action="/" method="post" class="my-4 form-inline">
        <div class="mb-3">
          <input required placeholder="Url" class="col form-control" type="text" name="url" id="url" />
          <div id="emailHelp" class="form-text">Please provide a real url so we dont get mad about it, okay?</div>
        </div>

        <button class="btn btn-primary" type="submit">Shorten it</button>
      </form>

      <h2>Most clicked 10 urls</h2>
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>Full URL</th>
              <th>Short URL</th>
              <th>Clicks</th>
            </tr>
          </thead>
          <tbody>
            <% if (typeof urls !== "undefined") { %> <% urls.forEach((url) => { %>
            <tr>
              <td>
                <a href="<%= url.full %>"><%= url.full %></a>
              </td>
              <td>
                <a href="/<%= url.short %>"><%= url.short %></a>
              </td>
              <td><%= url.clicks %></td>
            </tr>
            <% }) %> <% } else { %> <% } %>
          </tbody>
        </table>
      </div>
    </div>
  </body>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <% if (typeof post !== "undefined") { %>
  <script>
    setTimeout(() => (window.location.href = "/"), 5000);
  </script>
  <% } %>
</html>
